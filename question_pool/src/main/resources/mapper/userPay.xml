<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userPay"> <!-- mapper파일의 이름 -->


	<select id="paymentUser" parameterType="userPayment.UserPayVo" resultType = "userPayment.UserPayVo">
		select * from user where user_no = #{user_no}
	</select>
	
	<insert id = "payInsert" parameterType="userPayment.UserPayVo">
			INSERT INTO payment(pay_date, pay_id, user_no, product_no, merchant_id)
			VALUES (NOW(), #{pay_id}, #{user_no}, #{product_no}, #{merchant_id})
	</insert>
	
	<update id="userGrade" parameterType="userPayment.UserPayVo">
		UPDATE user SET user_grade = 1 WHERE user_no = #{user_no}
	</update>
	
	<update id="refundUpdate" parameterType="userPayment.UserPayVo">
		UPDATE payment SET refund = 1, refund_reason = #{refund_reason} WHERE refund = 0 AND user_no = #{user_no} ORDER BY pay_date DESC limit 1
	</update>
	
	
</mapper>